name: GMA3Plugins Packager

on:
  push:
    branches: [ workflows-packager ]
  pull_request:
    branches: [ master ]

jobs:
  package:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Make Package Path
      run: mkdir -p /tmp/Package/grandMA3/shared/resource/lib_plugins
    
    - name: Copy Files to Package
      run: |
        TMP_PATH=Package
        PLUGIN=grandMA3/shared/resource/lib_plugins
        cp -v README.md $TMP_PATH
        cp -v LICENSE /tmp/Package/LICENSE.txt
        cp -vr ${PLUGIN}/AppearanceBuilder/. $TMP_PATH
        cp -vr ${PLUGIN}/"Assign AutoStart Fix"/. $TMP_PATH
        cp -vr ${PLUGIN}/"Copy Screenshots"/. $TMP_PATH
        cp -vr ${PLUGIN}/"Random Select"/. $TMP_PATH
        find . -name "libcache.dat" -type f -delete -print
    
    - name: Upload artifact
      uses: actions/upload-artifact@v1
      with:
        name: GMA3Plugins-vX
        path: ./Package
